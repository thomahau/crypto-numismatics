!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";const o="https://api.coinmarketcap.com/v1/";let r;function a(){if(localStorage.getItem("token")&&localStorage.getItem("username")){const e=localStorage.getItem("username"),t=localStorage.getItem("currency");UI.renderLoggedInNav(e),function(e){const t=o+`ticker/?limit=0&convert=${e}`;return fetch(t).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok.")})}(t).then(e=>{r=e,UI.renderPortfolio()}).catch(e=>console.error(e))}else $(".welcome-container, .stats-wrapper").attr("hidden",!1)}function s(){$(".register-form").submit(function(e){e.preventDefault();const t={username:$("#register-username").val(),password:$("#register-password").val(),passwordconfirm:$("#register-password-confirm").val()};(function(e){let t;return fetch("users",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>(t=e).json()).then(e=>{if(t.ok)return e;throw`${e.reason}: ${e.location} ${e.message}`})})(t).then(e=>{UI.renderSignupSuccessMsg(e.username),function(e){const t={username:e.username,password:e.password};$(".modal").on("click",".first-login",function(){c(t).then(e=>{localStorage.setItem("username",e.username),localStorage.setItem("token",e.authToken),localStorage.setItem("currency","USD"),$(".modal").attr("hidden",!0),a()}).catch(e=>console.error(e))})}(t)}).catch(e=>{UI.renderSignupHelpMsg(e)})})}function c(e){return fetch("auth/login",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>{if(e.ok)return e.json();throw"ValidationError: Invalid username or password"})}$(function(){a(),UI.handleModals(),s(),$(".login-form").submit(function(e){e.preventDefault(),c({username:$("#login-username").val(),password:$("#login-password").val()}).then(e=>{localStorage.getItem("currency"),localStorage.setItem("username",e.username),localStorage.setItem("token",e.authToken),$(".modal").attr("hidden",!0),a()}).catch(e=>{UI.renderLoginHelpMsg(e)})}),$("header").on("click",".js-logout",function(){localStorage.removeItem("username"),localStorage.removeItem("token"),location.reload()}),UI.handleSettingsDropdown()})}]);